{"version":3,"file":"discord-time.js","sourceRoot":"","sources":["../../../src/components/discord-time/discord-time.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, h, Host, Prop, State } from '@stencil/core';\n\nconst DATE_TYPE_FORMATS = {\n\tt: { timeStyle: 'short' },\n\tT: { timeStyle: 'medium' },\n\td: { dateStyle: 'short' },\n\tD: { dateStyle: 'long' },\n\tf: { dateStyle: 'long', timeStyle: 'short' },\n\tF: { dateStyle: 'full', timeStyle: 'short' },\n\tR: { style: 'long', numeric: 'auto' }\n} as const;\n\n// max: [unit, per unit]\nconst RELATIVE_DATE_CONVERSION = {\n\t60000: ['second', 1000],\n\t3600000: ['minute', 60000],\n\t86400000: ['hour', 3600000],\n\t604800000: ['day', 86400000],\n\t2419200000: ['week', 604800000],\n\t29030400000: ['month', 2419200000],\n\t290304000000: ['year', 29030400000]\n} as const;\n\n@Component({\n\ttag: 'discord-time',\n\tstyleUrl: 'discord-time.css'\n})\nexport class DiscordTime {\n\t/**\n\t * The time to display.\n\t */\n\t@Prop()\n\tpublic timestamp: number;\n\n\t/**\n\t * The format for the time.\n\t */\n\t@Prop()\n\tpublic format: 't' | 'T' | 'f' | 'F' | 'd' | 'D' | 'R' = 't';\n\n\t// Private variables\n\t@State() private time = '';\n\tprivate updateInterval: number | undefined;\n\n\tpublic render() {\n\t\treturn <Host class=\"discord-time\">{this.time}</Host>;\n\t}\n\n\t// Lifecycle methods\n\tpublic connectedCallback() {\n\t\tthis.update();\n\t}\n\n\tpublic disconnectedCallback() {\n\t\twindow.clearInterval(this.updateInterval);\n\t}\n\n\t/**\n\t * Generates a string for the time.\n\t */\n\tprivate update() {\n\t\tconst date = new Date(this.timestamp);\n\n\t\tif (this.format === 'R') {\n\t\t\tconst [formatted, interval] = getRelativeDate(date);\n\t\t\tthis.time = formatted;\n\n\t\t\t// Update the time according to the interval\n\t\t\tif (this.updateInterval) window.clearInterval(this.updateInterval);\n\t\t\tif (interval > -1) this.updateInterval = window.setInterval(() => this.update(), interval);\n\t\t} else {\n\t\t\tthis.time = date.toLocaleString(undefined, DATE_TYPE_FORMATS[this.format]);\n\t\t}\n\t}\n}\n\n// [formatted, updateInterval]\nfunction getRelativeDate(date: Date): [string, number] {\n\tconst difference = Date.now() - date.getTime();\n\tconst diffAbsolute = Math.abs(difference);\n\n\tconst ending = difference < 0 ? 'from now' : 'ago';\n\n\tif (diffAbsolute < 5000) {\n\t\treturn ['Just now', 1000];\n\t}\n\n\tfor (const [time, [unit, per]] of Object.entries(RELATIVE_DATE_CONVERSION)) {\n\t\tif (diffAbsolute < Number(time)) {\n\t\t\tconst amount = Math.round(diffAbsolute / per);\n\n\t\t\treturn [`${amount} ${unit}${amount === 1 ? '' : 's'} ${ending}`, unit === 'second' ? 1000 : 60 * 1000];\n\t\t}\n\t}\n\n\treturn [`${Math.floor(diffAbsolute / 290304000000)} years ${ending}`, -1];\n}\n"]}